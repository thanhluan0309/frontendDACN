{"ast":null,"code":"'use strict';\n\nconst Mailer = require('./mailer');\n\nconst shared = require('./shared');\n\nconst SMTPPool = require('./smtp-pool');\n\nconst SMTPTransport = require('./smtp-transport');\n\nconst SendmailTransport = require('./sendmail-transport');\n\nconst StreamTransport = require('./stream-transport');\n\nconst JSONTransport = require('./json-transport');\n\nconst SESTransport = require('./ses-transport');\n\nconst nmfetch = require('./fetch');\n\nconst packageData = require('../package.json');\n\nconst ETHEREAL_API = (process.env.ETHEREAL_API || 'https://api.nodemailer.com').replace(/\\/+$/, '');\nconst ETHEREAL_WEB = (process.env.ETHEREAL_WEB || 'https://ethereal.email').replace(/\\/+$/, '');\nconst ETHEREAL_CACHE = ['true', 'yes', 'y', '1'].includes((process.env.ETHEREAL_CACHE || 'yes').toString().trim().toLowerCase());\nlet testAccount = false;\n\nmodule.exports.createTransport = function (transporter, defaults) {\n  let urlConfig;\n  let options;\n  let mailer;\n\n  if ( // provided transporter is a configuration object, not transporter plugin\n  typeof transporter === 'object' && typeof transporter.send !== 'function' || // provided transporter looks like a connection url\n  typeof transporter === 'string' && /^(smtps?|direct):/i.test(transporter)) {\n    if (urlConfig = typeof transporter === 'string' ? transporter : transporter.url) {\n      // parse a configuration URL into configuration options\n      options = shared.parseConnectionUrl(urlConfig);\n    } else {\n      options = transporter;\n    }\n\n    if (options.pool) {\n      transporter = new SMTPPool(options);\n    } else if (options.sendmail) {\n      transporter = new SendmailTransport(options);\n    } else if (options.streamTransport) {\n      transporter = new StreamTransport(options);\n    } else if (options.jsonTransport) {\n      transporter = new JSONTransport(options);\n    } else if (options.SES) {\n      transporter = new SESTransport(options);\n    } else {\n      transporter = new SMTPTransport(options);\n    }\n  }\n\n  mailer = new Mailer(transporter, options, defaults);\n  return mailer;\n};\n\nmodule.exports.createTestAccount = function (apiUrl, callback) {\n  let promise;\n\n  if (!callback && typeof apiUrl === 'function') {\n    callback = apiUrl;\n    apiUrl = false;\n  }\n\n  if (!callback) {\n    promise = new Promise((resolve, reject) => {\n      callback = shared.callbackPromise(resolve, reject);\n    });\n  }\n\n  if (ETHEREAL_CACHE && testAccount) {\n    setImmediate(() => callback(null, testAccount));\n    return promise;\n  }\n\n  apiUrl = apiUrl || ETHEREAL_API;\n  let chunks = [];\n  let chunklen = 0;\n  let req = nmfetch(apiUrl + '/user', {\n    contentType: 'application/json',\n    method: 'POST',\n    body: Buffer.from(JSON.stringify({\n      requestor: packageData.name,\n      version: packageData.version\n    }))\n  });\n  req.on('readable', () => {\n    let chunk;\n\n    while ((chunk = req.read()) !== null) {\n      chunks.push(chunk);\n      chunklen += chunk.length;\n    }\n  });\n  req.once('error', err => callback(err));\n  req.once('end', () => {\n    let res = Buffer.concat(chunks, chunklen);\n    let data;\n    let err;\n\n    try {\n      data = JSON.parse(res.toString());\n    } catch (E) {\n      err = E;\n    }\n\n    if (err) {\n      return callback(err);\n    }\n\n    if (data.status !== 'success' || data.error) {\n      return callback(new Error(data.error || 'Request failed'));\n    }\n\n    delete data.status;\n    testAccount = data;\n    callback(null, testAccount);\n  });\n  return promise;\n};\n\nmodule.exports.getTestMessageUrl = function (info) {\n  if (!info || !info.response) {\n    return false;\n  }\n\n  let infoProps = new Map();\n  info.response.replace(/\\[([^\\]]+)\\]$/, (m, props) => {\n    props.replace(/\\b([A-Z0-9]+)=([^\\s]+)/g, (m, key, value) => {\n      infoProps.set(key, value);\n    });\n  });\n\n  if (infoProps.has('STATUS') && infoProps.has('MSGID')) {\n    return (testAccount.web || ETHEREAL_WEB) + '/message/' + infoProps.get('MSGID');\n  }\n\n  return false;\n};","map":{"version":3,"names":["Mailer","require","shared","SMTPPool","SMTPTransport","SendmailTransport","StreamTransport","JSONTransport","SESTransport","nmfetch","packageData","ETHEREAL_API","process","env","replace","ETHEREAL_WEB","ETHEREAL_CACHE","includes","toString","trim","toLowerCase","testAccount","module","exports","createTransport","transporter","defaults","urlConfig","options","mailer","send","test","url","parseConnectionUrl","pool","sendmail","streamTransport","jsonTransport","SES","createTestAccount","apiUrl","callback","promise","Promise","resolve","reject","callbackPromise","setImmediate","chunks","chunklen","req","contentType","method","body","Buffer","from","JSON","stringify","requestor","name","version","on","chunk","read","push","length","once","err","res","concat","data","parse","E","status","error","Error","getTestMessageUrl","info","response","infoProps","Map","m","props","key","value","set","has","web","get"],"sources":["D:/ReactJS/DoAn_CN/my-app/node_modules/nodemailer/lib/nodemailer.js"],"sourcesContent":["'use strict';\n\nconst Mailer = require('./mailer');\nconst shared = require('./shared');\nconst SMTPPool = require('./smtp-pool');\nconst SMTPTransport = require('./smtp-transport');\nconst SendmailTransport = require('./sendmail-transport');\nconst StreamTransport = require('./stream-transport');\nconst JSONTransport = require('./json-transport');\nconst SESTransport = require('./ses-transport');\nconst nmfetch = require('./fetch');\nconst packageData = require('../package.json');\n\nconst ETHEREAL_API = (process.env.ETHEREAL_API || 'https://api.nodemailer.com').replace(/\\/+$/, '');\nconst ETHEREAL_WEB = (process.env.ETHEREAL_WEB || 'https://ethereal.email').replace(/\\/+$/, '');\nconst ETHEREAL_CACHE = ['true', 'yes', 'y', '1'].includes((process.env.ETHEREAL_CACHE || 'yes').toString().trim().toLowerCase());\n\nlet testAccount = false;\n\nmodule.exports.createTransport = function (transporter, defaults) {\n    let urlConfig;\n    let options;\n    let mailer;\n\n    if (\n        // provided transporter is a configuration object, not transporter plugin\n        (typeof transporter === 'object' && typeof transporter.send !== 'function') ||\n        // provided transporter looks like a connection url\n        (typeof transporter === 'string' && /^(smtps?|direct):/i.test(transporter))\n    ) {\n        if ((urlConfig = typeof transporter === 'string' ? transporter : transporter.url)) {\n            // parse a configuration URL into configuration options\n            options = shared.parseConnectionUrl(urlConfig);\n        } else {\n            options = transporter;\n        }\n\n        if (options.pool) {\n            transporter = new SMTPPool(options);\n        } else if (options.sendmail) {\n            transporter = new SendmailTransport(options);\n        } else if (options.streamTransport) {\n            transporter = new StreamTransport(options);\n        } else if (options.jsonTransport) {\n            transporter = new JSONTransport(options);\n        } else if (options.SES) {\n            transporter = new SESTransport(options);\n        } else {\n            transporter = new SMTPTransport(options);\n        }\n    }\n\n    mailer = new Mailer(transporter, options, defaults);\n\n    return mailer;\n};\n\nmodule.exports.createTestAccount = function (apiUrl, callback) {\n    let promise;\n\n    if (!callback && typeof apiUrl === 'function') {\n        callback = apiUrl;\n        apiUrl = false;\n    }\n\n    if (!callback) {\n        promise = new Promise((resolve, reject) => {\n            callback = shared.callbackPromise(resolve, reject);\n        });\n    }\n\n    if (ETHEREAL_CACHE && testAccount) {\n        setImmediate(() => callback(null, testAccount));\n        return promise;\n    }\n\n    apiUrl = apiUrl || ETHEREAL_API;\n\n    let chunks = [];\n    let chunklen = 0;\n\n    let req = nmfetch(apiUrl + '/user', {\n        contentType: 'application/json',\n        method: 'POST',\n        body: Buffer.from(\n            JSON.stringify({\n                requestor: packageData.name,\n                version: packageData.version\n            })\n        )\n    });\n\n    req.on('readable', () => {\n        let chunk;\n        while ((chunk = req.read()) !== null) {\n            chunks.push(chunk);\n            chunklen += chunk.length;\n        }\n    });\n\n    req.once('error', err => callback(err));\n\n    req.once('end', () => {\n        let res = Buffer.concat(chunks, chunklen);\n        let data;\n        let err;\n        try {\n            data = JSON.parse(res.toString());\n        } catch (E) {\n            err = E;\n        }\n        if (err) {\n            return callback(err);\n        }\n        if (data.status !== 'success' || data.error) {\n            return callback(new Error(data.error || 'Request failed'));\n        }\n        delete data.status;\n        testAccount = data;\n        callback(null, testAccount);\n    });\n\n    return promise;\n};\n\nmodule.exports.getTestMessageUrl = function (info) {\n    if (!info || !info.response) {\n        return false;\n    }\n\n    let infoProps = new Map();\n    info.response.replace(/\\[([^\\]]+)\\]$/, (m, props) => {\n        props.replace(/\\b([A-Z0-9]+)=([^\\s]+)/g, (m, key, value) => {\n            infoProps.set(key, value);\n        });\n    });\n\n    if (infoProps.has('STATUS') && infoProps.has('MSGID')) {\n        return (testAccount.web || ETHEREAL_WEB) + '/message/' + infoProps.get('MSGID');\n    }\n\n    return false;\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}